<ion-content [fullscreen]="true" class="home-container">
  
  <div class="header-section">
    <div class="user-greeting">
      <h1>Olá, {{ nomeUsuario }}</h1>
      <p>O que você gostaria de pedir hoje?</p>
    </div>
    <div class="profile-avatar" (click)="goToProfile()">
      <ion-icon name="person"></ion-icon>
    </div>
  </div>

  <div class="category-tabs">
    <div class="tab-item" 
         [class.active]="selectedCategory === 'comida'" 
         (click)="selectCategory('comida')">
      <span>COMIDA</span>
    </div>
    <div class="tab-item" 
         [class.active]="selectedCategory === 'mercado'" 
         (click)="selectCategory('mercado')">
      <span>MERCADO</span>
    </div>
    <div class="tab-item" 
         [class.active]="selectedCategory === 'farmacia'" 
         (click)="selectCategory('farmacia')">
      <span>FARMÁCIA</span>
    </div>
    <div class="tab-item" 
         [class.active]="selectedCategory === 'construcao'" 
         (click)="selectCategory('construcao')">
      <span>CONSTRUÇÃO</span>
    </div>
  </div>

  <div class="content-section">
    
    <div *ngIf="selectedCategory === 'comida'" class="category-content">
      <div class="section-title">
        <h2>Comida</h2>
        <ion-icon name="restaurant"></ion-icon>
      </div>
      <div class="establishments-grid">
        <div *ngFor="let est of estabelecimentosComida" class="establishment-card" (click)="goToEstablishment(est.id)">
          <div class="card-background" [ngStyle]="{'background-image': 'url(' + (est.banner_url || 'assets/mcdonalds-cred-Sombat-Muycheen-shutterstock_site.webp') + ')'}">
            <div class="card-content">
              <div class="logo">
                <img [src]="est.logo_url || 'assets/mcquadrado.png'" [alt]="est.nome" />
              </div>
              <div class="info">
                <h3>{{ est.nome }}</h3>
                <div class="details">
                  <div class="rating">
                    <ion-icon name="star"></ion-icon>
                    <span>4.5</span>
                  </div>
                  <div class="time">
                    <ion-icon name="time-outline"></ion-icon>
                    <span>{{ est.tempo_de_espera || '20-30' }} min</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="selectedCategory === 'mercado'" class="category-content">
      <div class="section-title">
        <h2>Mercado</h2>
        <ion-icon name="storefront"></ion-icon>
      </div>
      <div class="establishments-grid">
        <div *ngFor="let est of estabelecimentosMercado" class="establishment-card" (click)="goToEstablishment(est.id)">
           <div class="card-background" [ngStyle]="{'background-image': 'url(' + (est.banner_url || 'assets/mcdonalds-cred-Sombat-Muycheen-shutterstock_site.webp') + ')'}">
            <div class="card-content">
              <div class="logo">
                <img [src]="est.logo_url || 'assets/mcquadrado.png'" [alt]="est.nome" />
              </div>
              <div class="info">
                <h3>{{ est.nome }}</h3>
                <div class="details">
                  <div class="rating">
                    <ion-icon name="star"></ion-icon>
                    <span>4.2</span>
                  </div>
                  <div class="time">
                    <ion-icon name="time-outline"></ion-icon>
                    <span>{{ est.tempo_de_espera || '30-40' }} min</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="selectedCategory === 'farmacia'" class="category-content">
      <div class="section-title">
        <h2>Farmácia</h2>
        <ion-icon name="medical"></ion-icon>
      </div>
      <div class="establishments-grid">
        <div *ngFor="let est of estabelecimentosFarmacia" class="establishment-card" (click)="goToEstablishment(est.id)">
           <div class="card-background" [ngStyle]="{'background-image': 'url(' + (est.banner_url || 'assets/mcdonalds-cred-Sombat-Muycheen-shutterstock_site.webp') + ')'}">
            <div class="card-content">
              <div class="logo">
                <img [src]="est.logo_url || 'assets/mcquadrado.png'" [alt]="est.nome" />
              </div>
              <div class="info">
                <h3>{{ est.nome }}</h3>
                <div class="details">
                  <div class="rating">
                    <ion-icon name="star"></ion-icon>
                    <span>4.7</span>
                  </div>
                  <div class="time">
                    <ion-icon name="time-outline"></ion-icon>
                    <span>{{ est.tempo_de_espera || '10-20' }} min</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="selectedCategory === 'construcao'" class="category-content">
      <div class="section-title">
        <h2>Construção</h2>
        <ion-icon name="construct"></ion-icon>
      </div>
      <div class="establishments-grid">
         <div *ngIf="estabelecimentosConstrucao.length === 0" class="empty-category">
           <p>Nenhum estabelecimento de construção encontrado.</p>
         </div>
        <div *ngFor="let est of estabelecimentosConstrucao" class="establishment-card" (click)="goToEstablishment(est.id)">
           <div class="card-background" [ngStyle]="{'background-image': 'url(' + (est.banner_url || 'assets/mcdonalds-cred-Sombat-Muycheen-shutterstock_site.webp') + ')'}">
            <div class="card-content">
              <div class="logo">
                <img [src]="est.logo_url || 'assets/mcquadrado.png'" [alt]="est.nome" />
              </div>
              <div class="info">
                <h3>{{ est.nome }}</h3>
                <div class="details">
                  <div class="rating">
                    <ion-icon name="star"></ion-icon>
                    <span>4.0</span>
                  </div>
                  <div class="time">
                    <ion-icon name="time-outline"></ion-icon>
                    <span>{{ est.tempo_de_espera || 'N/A' }} min</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="fixed-bottom-nav">
    <div class="nav-content">
      <div class="nav-item active" (click)="goToTab('home')">
        <ion-icon name="home"></ion-icon>
        <span>Início</span>
      </div>
      
      <div class="nav-item" (click)="goToTab('search')">
        <ion-icon name="search"></ion-icon>
        <span>Buscar</span>
      </div>
      
       <div class="nav-item" [routerLink]="['/sacola']">
        <ion-icon name="bag-handle"></ion-icon>
        <span>Sacola</span>
      </div>
      
      <div class="nav-item" (click)="goToTab('profile')">
        <ion-icon name="person"></ion-icon>
        <span>Perfil</span>
      </div>
    </div>
  </div>

</ion-content>